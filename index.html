<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Detective AI Assistant</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Roboto&display=swap');

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      background: #0a0f14;
      color: #00ffea;
      font-family: 'Orbitron', 'Roboto', sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      max-width: 900px;
      margin: 0 auto;
      padding: 15px;
    }

    #chat-container {
      background: #121b22;
      border-radius: 15px 15px 0 0;
      box-shadow: 0 0 20px #00ffe7aa inset;
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      font-size: 1rem;
      line-height: 1.4;
      color: #a4f9f5;
      scrollbar-width: thin;
      scrollbar-color: #00ffe7 #0a0f14;
    }

    #chat-container::-webkit-scrollbar {
      width: 8px;
    }
    #chat-container::-webkit-scrollbar-track {
      background: #0a0f14;
    }
    #chat-container::-webkit-scrollbar-thumb {
      background: #00ffe7cc;
      border-radius: 4px;
    }

    .message {
      margin-bottom: 18px;
      max-width: 75%;
      word-wrap: break-word;
      padding: 12px 18px;
      border-radius: 18px;
      box-shadow: 0 0 8px #00ffe7bb;
      font-family: 'Roboto', sans-serif;
      font-size: 1rem;
    }

    /* YOU are on the left */
    .message.user {
      background: #00504f;
      align-self: flex-start;
      border-top-right-radius: 0;
    }

    /* AI is on the right */
    .message.bot {
      background: #003939;
      align-self: flex-end;
      border-top-left-radius: 0;
    }

    #input-area {
      display: flex;
      background: #071011;
      padding: 12px 16px;
      border-radius: 0 0 15px 15px;
      box-shadow: 0 0 20px #00ffe7aa;
    }

    #input-area input[type="text"] {
      flex: 1;
      border: none;
      outline: none;
      border-radius: 8px;
      padding: 12px 16px;
      font-size: 1rem;
      font-family: 'Roboto', sans-serif;
      background: #011c1a;
      color: #00fff7;
      box-shadow: inset 0 0 10px #008070;
      transition: box-shadow 0.3s ease;
    }

    #input-area input[type="text"]:focus {
      box-shadow: inset 0 0 15px #00ffe7;
    }

    #input-area button {
      margin-left: 12px;
      background: #00ffe7;
      border: none;
      border-radius: 10px;
      color: #003333;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      padding: 0 20px;
      transition: background-color 0.3s ease;
      box-shadow: 0 0 12px #00ffe7;
    }

    #input-area button:hover {
      background: #00d8c9;
    }

    @media (max-width: 600px) {
      #chat-container {
        font-size: 0.9rem;
      }
      #input-area input[type="text"] {
        font-size: 0.9rem;
      }
      #input-area button {
        font-size: 1rem;
        padding: 0 16px;
      }
    }
  </style>
</head>
<body>

<main>
  <div id="chat-container" aria-live="polite" aria-label="Chat messages">
    <!-- Messages will appear here -->
  </div>

  <form id="chat-form" action="https://formspree.io/f/xkgvqwnw" method="POST" target="_blank">
    <!-- Replace your_form_id with your actual Formspree ID -->
    <div id="input-area">
      <input type="text" name="message" id="user-input" autocomplete="off" placeholder="Describe your situation..." required />
      <button type="submit" aria-label="Send message">➤</button>
    </div>
  </form>
</main>

<script>
  const chatContainer = document.getElementById('chat-container');
  const chatForm = document.getElementById('chat-form');
  const userInput = document.getElementById('user-input');

  const questions = [
    "Greetings. I’m Detective AI. Please tell me your full name.",
    "Thank you. How old are you?",
    "When did the incident happen?",
    "Where did it occur? Be specific.",
    "Can you describe the person(s) involved?",
    "What exactly happened?",
    "Did you report this to anyone?",
    "How has this affected your well-being?",
    "Is there any evidence you can share?",
    "I’ve recorded your statement. Our team will handle this seriously."
  ];

  let currentQuestionIndex = 0;
  let userResponses = [];

  function appendMessage(text, sender = 'bot') {
    const msg = document.createElement('div');
    msg.className = 'message ' + sender;
    msg.textContent = text;
    chatContainer.appendChild(msg);
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }

  function startChat() {
    appendMessage(questions[0], 'bot');
  }

  chatForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const input = userInput.value.trim();
    if (!input) return;

    appendMessage(input, 'user');
    userResponses.push(input);
    userInput.value = '';

    // Save to localStorage for team access
    localStorage.setItem('clientReports', JSON.stringify(userResponses));

    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) {
      setTimeout(() => {
        appendMessage(questions[currentQuestionIndex], 'bot');
      }, 800);
    } else {
      setTimeout(() => {
        appendMessage("Thank you. Your report is secured. We’re taking over from here.", 'bot');
      }, 1000);
    }
  });

  window.onload = () => {
    chatContainer.innerHTML = '';
    currentQuestionIndex = 0;
    userResponses = [];
    startChat();
  };
</script>

</body>
</html>
